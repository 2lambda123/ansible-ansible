---
- gather_facts: no
  hosts: myvc
  tasks:
  - name: Create a virtual machine on NVMe controller
    vmware_guest:
      hostname: "10.10.10.10"
      username: "Administrator"
      password: "Admin"
      validate_certs: False
      datacenter: datacenter
      folder: ""
      name: test_auto_deploy_win10_64_bios_15disks
      state: poweredon
      guest_id: windows9_64Guest
      # This is hostname of particular ESXi server on which user wants VM to be deployed
      esxi_hostname: "6.7GAhost"
      disk:
      - size_gb: 40
        type: thin
        datastore: datastore1
      - size_gb: 2
        type: thin
        datastore: datastore1
      - size_gb: 2
        type: eagerzeroedthick
        datastore: datastore1
      - size_gb: 2
        type: thin
        datastore: datastore1
      - size_gb: 3
        type: thin
        datastore: datastore1
      - size_gb: 1
        type: eagerzeroedthick
        datastore: datastore1
      - size_gb: 1
        type: thin
        datastore: datastore1
      - size_gb: 4
        type: thin
        datastore: datastore1
      - size_gb: 2
        type: thin
        datastore: datastore1
      - size_gb: 2
        type: eagerzeroedthick
        datastore: datastore1
      - size_gb: 2
        type: thin
        datastore: datastore1
      - size_gb: 3
        type: thin
        datastore: datastore1
      - size_gb: 1
        type: eagerzeroedthick
        datastore: datastore1
      - size_gb: 1
        type: thin
        datastore: datastore1
      - size_gb: 1
        type: thin
        datastore: datastore1
      hardware:
        version: 14
        memory_mb: 4096
        num_cpus: 2
        num_cpu_cores_per_socket: 1
        # scsi: paravirtual
        nvme: nvme
        boot_firmware: bios
      networks:
      - name: VM Network
        device_type: vmxnet3
        type: dhcp
      cdrom:
        type: iso
        iso_path: "[gosvpub] Windows/Windows10/windows.iso"
    delegate_to: localhost
    register: deploy_vm
...
