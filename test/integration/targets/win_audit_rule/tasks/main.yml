- name: create temporary folder to test with
  win_file:
    path: "{{ test_audit_rule_folder }}"
    state: directory

- name: create temporary registry key to test with
  win_regedit:
    path: "{{ test_audit_rule_registry }}"

- block:
    - include_tasks: tests.yml
  always:
  - name: remove testing folder
    win_file:
      path: "{{ test_audit_rule_folder }}"
      state: absent

  - name: remove registry key
    win_regedit:
      path: "{{ test_audit_rule_registry }}"
      state: absent
