---

- name: Install https transport for apt
  apt: name=apt-transport-https state=latest force=yes

- name: Add Erlang Solutions public GPG key
  apt_key: url=https://packages.erlang-solutions.com/ubuntu/erlang_solutions.asc state=present

- name: Add Erlang Solutions repository
  apt_repository: repo='deb https://packages.erlang-solutions.com/ubuntu trusty contrib' filename='erlang-solutions' state=present update_cache=yes

- name: Add RabbitMQ public GPG key
  apt_key: url=https://www.rabbitmq.com/rabbitmq-release-signing-key.asc state=present

- name: Add RabbitMQ repository
  apt_repository: repo='deb https://dl.bintray.com/rabbitmq/debian trusty main' filename='rabbitmq' state=present update_cache=yes

- name: Install RabbitMQ Server
  apt: name=rabbitmq-server state=latest

- name: Start RabbitMQ service
  service: name=rabbitmq-server state=started
