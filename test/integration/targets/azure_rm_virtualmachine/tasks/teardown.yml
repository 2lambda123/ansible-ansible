- name: TEARDOWN | Destroy security group
  azure_rm_securitygroup:
    resource_group: "{{ resource_group }}"
    name: "{{ vm_name }}"
    state: absent

- name: TEARDOWN | Destroy subnet
  azure_rm_subnet:
      resource_group: "{{ resource_group }}"
      virtual_network: "{{ vm_name }}"
      name: "{{ vm_name }}"
      state: absent

- name: TEARDOWN | Destroy virtual network
  azure_rm_virtualnetwork:
    resource_group: "{{ resource_group }}"
    name: "{{ vm_name }}"
    state: absent

- name: TEARDOWN | Destroy public ip
  azure_rm_publicipaddress:
    resource_group: "{{ resource_group }}"
    name: "{{ vm_name }}"
    state: absent

- name: TEARDOWN | Destroy availability set
  azure_rm_availabilityset:
    resource_group: "{{ resource_group }}"
    name: "{{ availability_set }}"
    state: absent

- name: TEARDOWN | Destroy storage account
  azure_rm_storageaccount:
    resource_group: "{{ resource_group }}"
    name: "{{ storage_account }}"
    force_delete_nonempty: true
    state: absent
