---
- hosts: localhost
  gather_facts: no
  tasks:
  - name: test builtin
    ns.coll.test_redirect:
      name: ping
      assert: ['ping']

  - name: test builtin with collections kw
    ns.coll.test_redirect:
      name: ping
      assert: ['ping']
    collections:
      - testns.unrelatedcoll

  - name: test redirected builtin
    ns.coll.test_redirect:
      name: formerly_core_ping
      assert:
        - formerly_core_ping
        - ansible.builtin.formerly_core_ping
        - testns.testcoll.ping

  - name: test redirected builtin with collections kw
    ns.coll.test_redirect:
      name: formerly_core_ping
      assert:
        - formerly_core_ping
        - ansible.builtin.formerly_core_ping
        - testns.testcoll.ping
    collections:
      - testns.unrelatedcoll
      - testns.testcoll

  - name: test collection module with collections kw
    ns.coll.test_redirect:
      name: ping
      assert:
        - ping
        - testns.testcoll.ping
    collections:
      - testns.unrelatedcoll
      - testns.testcoll

  - name: test redirected collection module with collections kw
    ns.coll.test_redirect:
      name: ping
      assert:
        - ping
        - testns.testredirect.ping
        - testns.testcoll.ping
    collections:
      - testns.unrelatedcoll
      - testns.testredirect

  - name: test legacy module with collections kw
    ns.coll.test_redirect:
      name: legacy_ping
      assert:
        - legacy_ping
    collections:
      - testns.unrelatedcoll
