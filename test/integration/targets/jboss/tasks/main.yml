- name: Tests for jboss modules
  block:

  - import_tasks: jboss.yml
    when:
    - ansible_distribution == 'CentOS'
    - ansible_distribution_major_version is version('7', '>=')

  always:
  # Clean up:
  - name: Stop wildfly (jboss)
    systemd:
      name: wildfly
      state: stopped
    register: wildfly_stopped
    when:
    - ansible_distribution == 'CentOS'
    - ansible_distribution_major_version is version('7', '>=')

  - name: Remove jboss test directory
    file:
      path: '{{ remote_tmp_dir }}'
      state: absent
    when: wildfly_stopped
    when:
    - ansible_distribution == 'CentOS'
    - ansible_distribution_major_version is version('7', '>=')
