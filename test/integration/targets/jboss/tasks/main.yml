- name: Tests for jboss modules
  block:

  - import_tasks: jboss.yml
    when:
    - ansible_distribution == 'CentOS'
    - ansible_distribution_major_version is version('7', '>=')

  always:
  # Clean up:
  - name: Stop wildfly (jboss)
    systemd:
      name: wildfly
      state: stopped
    when:
    - ansible_distribution == 'CentOS'
    - ansible_distribution_major_version is version('7', '>=')
    ignore_errors: yes

  - name: Remove files
    file:
      path: '{{ item }}'
      state: absent
    loop:
    - '{{ remote_tmp_dir }}'
    - '{{ wf_service_file_path }}'
    when:
    - ansible_distribution == 'CentOS'
    - ansible_distribution_major_version is version('7', '>=')
