- file:
    path: "{{ playbook_dir }}/test_directory/{{ item }}"
    state: touch
  loop:
    - test.txt
    - tax.txt
  tags:
    - https

- name: HTTPS +add +mode -push_option
  register: result
  git_acp:
    folder_path: "{{ playbook_dir }}/test_directory"
    user: Federico87
    token: ZwM9RMWz4cEGwiynxtcw
    comment: Add [ test.txt, tax.txt ]
    add: [ test.txt, tax.txt ]
    branch: master
    mode: https
    url: https://gitlab.com/networkAutomation/git_test_module.git
  tags:
    - https

- assert: { that: "result.changed == true" }
  tags:
    - https

- file:
    path: "{{ playbook_dir }}/test_directory/{{ item }}"
    state: absent
  loop:
    - test.txt
    - tax.txt
  tags:
    - https

- name: HTTPS -add +mode +push_option
  register: result
  git_acp:
    folder_path: "{{ playbook_dir }}/test_directory"
    user: Federico87
    token: ZwM9RMWz4cEGwiynxtcw
    comment: Remove [ test.txt, tax.txt ]
    branch: master
    push_option: ci.skip
    mode: https
    url: https://gitlab.com/networkAutomation/git_test_module.git
  tags:
    - https

- assert: { that: "result.changed == true" }
  tags:
    - https

