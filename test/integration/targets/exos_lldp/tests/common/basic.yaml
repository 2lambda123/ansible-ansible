---
- debug:  msg="START common/basic.yaml on connection={{ ansible_connection }}"

- include_vars:
    file: request_body.yaml

- name: Enable single interface
  exos_lldp:
    interfaces: "1"
    state: present
  register: result
 
- assert: 
    that:
      - "result.changed == true"
      - "single_request == result.requests"

- name: Enable multiple interface
  exos_lldp:
    interfaces: "2,3"
    state: present
  register: result

- assert:
    that:
      - "result.changed == true"
      - "multiple_requests == result.requests"

- name: Test idempotency
  exos_lldp:
    interfaces: "1"
    state: present
  register: result

- assert:
    that:
      - "result.changed == false"
      - "result.requests == []"

- name: Test invalid interface
  exos_lldp:
    interfaces: "35"
    state: present
  ignore_errors: yes
  register: result

- assert:
    that:
      - "result.failed == true"
      - "result.msg == 'Invalid interface'"

- name: Disable interface
  exos_lldp:
    interfaces: "1"
    state: absent
  register: result

- assert:
    that:
      - "result.changed == true"
      - "delete_request == result.requests"

- name: Test interface range
  exos_lldp:
    interfaces: "4-6,9"
    state: present
  register: result

- assert:
    that:
      - "result.changed == true"
      - "interface_range == result.requests"

        
- debug: msg="END common/basic.yaml on connection={{ ansible_connection }}"
