- name: fail select and manage a specified disk because specified disk is not attached
  win_disk_management:
    # select_disk_by
    size: '{{test_win_disk_management_size}}'
    partition_style_select: raw
    operational_status: offline
    # set_disk_by
    drive_letter: '{{test_win_disk_management_letter}}'
    # module_output
    logging: verbose
  register: fail_not_attached
  failed_when: fail_not_attached.msg != 'No disk could be found and selected with the passed option values'

- name: fail select and manage a specified disk because specified disk could not be found
  win_disk_management:
    # select_disk_by
    size: 50
    number: 1
    partition_style_select: raw
    operational_status: offline
    # module_output
    logging: standard
  register: fail_not_found
  failed_when: fail_not_found.disk_selected.disk.total_found_disks != '0'

# Use result of module (disk number)
- name: fail select and manage a specified disk because specified disk is not attached, check results
  win_disk_management:
    # select_disk_by
    number: 1
    partition_style_select: raw
    operational_status: offline
    read_only: true
  register: setup_specified_disk
  failed_when: setup_specified_disk.msg != 'No disk could be found and selected with the passed option values'

- name: assert setup disk
  assert:
    that:
    - not setup_specified_disk|changed

- name: assert setup disk (normal mode)
  assert:
    that:
    - not setup_specified_disk|changed
  when: not in_check_mode

- name: assert setup disk (check mode)
  assert:
    that:
    - not setup_specified_disk|changed
  when: in_check_mode
