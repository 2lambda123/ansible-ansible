---
- name: disable disabled conf
  apache2_conf:
    type: conf
    name: conf_example.conf
    state: absent
  register: disable_disabled

- name: ensure apache2_conf is idempotent
  assert:
    that:
      - 'not disable_disabled.changed'

- name: enable conf
  apache2_conf:
    type: conf
    name: conf_example.conf
    state: present
  register: enable

- name: ensure changed on successful enable
  assert:
    that:
      - 'enable.changed'

- name: enable enabled conf
  apache2_conf:
    type: conf
    name: conf_example.conf
    state: present
  register: enable_enabled

- name: ensure apache2_conf is idempotent
  assert:
    that:
      - 'not enable_enabled.changed'

- name: disable conf
  apache2_conf:
    type: conf
    name: conf_example.conf
    state: absent
  register: disable

- name: ensure changed on successful disable
  assert:
    that:
      - 'disable.changed'

- name: enable nonexistent conf
  apache2_conf:
    type: conf
    name: conf_nonexistent.conf
    state: present
  register: enable_nonexistent
  ignore_errors: True

- name: ensure failed on nonexistent conf enable
  assert:
    that:
      - 'enable_nonexistent|failed'
      - 'not enable_nonexistent.changed'

- name: disable nonexistent conf
  apache2_conf:
    type: conf
    name: conf_nonexistent.conf
    state: absent
  register: disable_nonexistent
  ignore_errors: True

- name: ensure failed on nonexistent conf disable
  assert:
    that:
      - 'disable_nonexistent|failed'
      - 'not disable_nonexistent.changed'

- name: enable conf by short name
  apache2_conf:
    type: conf
    name: conf_example
    state: present
  register: enable_short

- name: ensure changed on successful enable
  assert:
    that:
      - 'enable_short.changed'

- name: disable conf by short name
  apache2_conf:
    type: conf
    name: conf_example
    state: absent
  register: disable_short

- name: ensure changed on successful disable
  assert:
    that:
      - 'disable_short.changed'

- name: enable wrong conf
  apache2_conf:
    type: conf
    name: /etc/resolv.conf
    state: present
  register: enable_wrong
  ignore_errors: True

- name: ensure failed on enable wrong conf
  assert:
    that:
      - 'enable_wrong|failed'
