---
- name: disable disabled mod
  apache2_conf:
    type: mod
    name: mod_example.load
    state: absent
  register: disable_disabled

- name: ensure apache2_conf is idempotent
  assert:
    that:
      - 'not disable_disabled.changed'

- name: enable mod
  apache2_conf:
    type: mod
    name: mod_example.load
    state: present
  register: enable

- name: ensure changed on successful enable
  assert:
    that:
      - 'enable.changed'

- name: enable enabled mod
  apache2_conf:
    type: mod
    name: mod_example.load
    state: present
  register: enable_enabled

- name: ensure apache2_conf is idempotent
  assert:
    that:
      - 'not enable_enabled.changed'

- name: disable mod
  apache2_conf:
    type: mod
    name: mod_example.load
    state: absent
  register: disable

- name: ensure changed on successful disable
  assert:
    that:
      - 'disable.changed'

- name: enable nonexistent mod
  apache2_conf:
    type: mod
    name: mod_nonexistent.load
    state: present
  register: enable_nonexistent
  ignore_errors: True

- name: ensure failed on nonexistent conf enable
  assert:
    that:
      - 'enable_nonexistent|failed'
      - 'not enable_nonexistent.changed'

- name: disable nonexistent mod
  apache2_conf:
    type: mod
    name: mod_nonexistent.load
    state: absent
  register: disable_nonexistent
  ignore_errors: True

- name: ensure failed on nonexistent conf disable
  assert:
    that:
      - 'disable_nonexistent|failed'
      - 'not disable_nonexistent.changed'

- name: enable mod by short name
  apache2_conf:
    type: mod
    name: mod_example
    state: present
  register: enable_short

- name: ensure changed on successful enable
  assert:
    that:
      - 'enable_short.changed'

- name: disable mod by short name
  apache2_conf:
    type: mod
    name: mod_example
    state: absent
  register: disable_short

- name: ensure changed on successful disable
  assert:
    that:
      - 'disable_short.changed'
