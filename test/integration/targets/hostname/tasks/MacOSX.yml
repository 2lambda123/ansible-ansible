- name: macOS | Get macOS hostname values
  command: scutil --get {{ item }}
  loop:
    - HostName
    - ComputerName
    - LocalHostName
  register: macos_scutil
  ignore_errors: yes

- name: macOS | Ensure all hostname values were set correctly
  assert:
    that:
      - "['bugs.acme.com', 'bugs.acme.com', 'bugsacmecom'] == macos_scutil.results | map(attribute='stdout') | list"

- name: macOS | Set to a hostname using spaces and punctuation
  hostname:
    name: The Dude's Computer

- name: macOS | Get macOS hostname values
  command: scutil --get {{ item }}
  loop:
    - HostName
    - ComputerName
    - LocalHostName
  register: macos_scutil_complex
  ignore_errors: yes

- name: macOS | Ensure all hostname values were set correctly
  assert:
    that:
      - "['The Dude\\'s Computer', 'The Dude\\'s Computer', 'The-Dudes-Computer'] == (macos_scutil_complex.results | map(attribute='stdout') | list)"

- name: macOS | Set all hostname values to the default
  command: scutil --set {{ item }} ''
  loop:
    - HostName
    - ComputerName
    - LocalHostName
  register: macos_scutil_complex

- name: macOS | Set hostname after being reset to defaults
  hostname:
    name: Macintosh
