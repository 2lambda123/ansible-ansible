- name: Create a broken symbolic link
  file:
    src: does_not_exist
    dest: link_to_nonexistent_file
    state: link
    force: yes
    follow: no

- name: Assert directory tests work
  assert:
    that:
      - "'.' is is_dir"  # old name
      - "'.' is directory"
      - "'does_not_exist' is not directory"

- name: Assert file tests work
  assert:
    that:
      - "(role_path + '/aliases') is is_file"  # old name
      - "(role_path + '/aliases') is file"
      - "'does_not_exist' is not file"

- name: Assert link tests work
  assert:
    that:
      - "'link_to_nonexistent_file' is link"
      - "'.' is not link"

- name: Assert exists tests work
  assert:
    that:
      - "(role_path + '/aliases') is exists"
      - "'link_to_nonexistent_file' is not exists"

- name: Assert link_exists tests work
  assert:
    that:
      - "'link_to_nonexistent_file' is link_exists"
      - "'does_not_exist' is not link_exists"

- name: Assert abs tests work
  assert:
    that:
      - "'/' is is_abs"  # old name
      - "'/' is abs"
      - "'../' is not abs"

- name: Assert same_file tests work
  assert:
    that:
      - "'/' is is_same_file('/')"  # old name
      - "'/' is same_file('/')"
      - "'/' is not same_file(role_path + '/aliases')"

- name: Assert mount tests work
  assert:
    that:
      - "'/' is is_mount"  # old name
      - "'/' is mount"
      - "'/does_not_exist' is not mount"

- set_fact: remote_tmp_dir_test={{remote_tmp_dir}}/test_test_empty

- name: Make sure our testing sub-directory does not exist
  file:
    state: absent
    path: "{{ remote_tmp_dir_test }}"

- name: Create our testing sub-directory
  file:
    state: directory
    path: "{{ remote_tmp_dir_test }}"

- name: Assert empty dir tests work
  assert:
    that:
      - "'{{ remote_tmp_dir_test }}' is empty"
      - "'{{ remote_tmp_dir_test }}' is empty(true)"
      - "'{{ remote_tmp_dir_test }}' is is_empty"
      - "'{{ remote_tmp_dir_test }}' is is_empty(true)"

- name: Create an empty file
  file:
    state: touch
    path: "{{ remote_tmp_dir_test }}/empty_file"

- name: Create an file with space
  copy:
    content: "     "
    dest: "{{ remote_tmp_dir_test }}/space_file"

- name: Create an file
  copy:
    content: "hello world!"
    dest: "{{ remote_tmp_dir_test }}/file"

- name: Assert empty file tests work
  assert:
    that:
      - "'{{ remote_tmp_dir_test }}/empty_file' is empty"
      - "'{{ remote_tmp_dir_test }}/empty_file' is empty(true)"
      - "'{{ remote_tmp_dir_test }}/space_file' is not is_empty"
      - "'{{ remote_tmp_dir_test }}/space_file' is is_empty(true)"
      - "'{{ remote_tmp_dir_test }}/file' is not is_empty"
      - "'{{ remote_tmp_dir_test }}/file' is not is_empty(true)"

- name: Assert empty dir tests work
  assert:
    that:
      - "'{{ remote_tmp_dir_test }}' is not empty"
      - "'{{ remote_tmp_dir_test }}' is not empty(true)"
