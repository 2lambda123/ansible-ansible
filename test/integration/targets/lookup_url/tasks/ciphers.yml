- name: test good cipher
  debug:
    msg: '{{ lookup("url", url, ciphers=[tls_strong_cipher]) }}'
  vars:
    url: https://{{ no_tls13_host }}:445/

- name: test bad cipher
  debug:
    msg: '{{ lookup("url", url, ciphers=[tls_weak_cipher]) }}'
  vars:
    url: https://{{ no_tls13_host }}:445/
  register: result
  ignore_errors: true

- assert:
    that:
      - result is failed
