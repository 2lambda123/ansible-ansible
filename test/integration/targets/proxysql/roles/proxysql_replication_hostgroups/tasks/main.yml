- name: check_mode create proxysql replication hostgroups
  proxysql_replication_hostgroups:
    login_user: "{{ proxy_sql_admin_user }}"
    login_password: "{{ proxy_sql_admin_password }}"
    state: present
    writer_hostgroup: "{{ hostgroup_writer }}"
    reader_hostgroup: "{{ hostgroup_reader }}"
    load_to_runtime: yes
  check_mode: yes
  register: out

- name: check_mode state must be changed
  assert:
    that:
      - out is changed

- name: create proxysql replication hostgroups
  proxysql_replication_hostgroups:
    login_user: "{{ proxy_sql_admin_user }}"
    login_password: "{{ proxy_sql_admin_password }}"
    state: present
    writer_hostgroup: "{{ hostgroup_writer }}"
    reader_hostgroup: "{{ hostgroup_reader }}"
    load_to_runtime: yes
  register: out

- name: state must be changed
  assert:
    that:
      - out is changed

- name: present proxysql replication hostgroups
  proxysql_replication_hostgroups:
    login_user: "{{ proxy_sql_admin_user }}"
    login_password: "{{ proxy_sql_admin_password }}"
    state: present
    writer_hostgroup: "{{ hostgroup_writer }}"
    reader_hostgroup: "{{ hostgroup_reader }}"
    load_to_runtime: yes
  register: out

- name: state must not be changed
  assert:
    that:
      - out is not changed

- name: add comment and change check_type
  proxysql_replication_hostgroups:
    login_user: "{{ proxy_sql_admin_user }}"
    login_password: "{{ proxy_sql_admin_password }}"
    state: present
    comment: ANSIBLE POWER!!!!
    check_type: innodb_read_only
    writer_hostgroup: "{{ hostgroup_writer }}"
    reader_hostgroup: "{{ hostgroup_reader }}"
    load_to_runtime: yes
  register: out

- name: state must be changed
  assert:
    that:
      - out is changed

- name: comment and check_type must be exists
  proxysql_replication_hostgroups:
    login_user: "{{ proxy_sql_admin_user }}"
    login_password: "{{ proxy_sql_admin_password }}"
    state: present
    comment: ANSIBLE POWER!!!!
    check_type: innodb_read_only
    writer_hostgroup: "{{ hostgroup_writer }}"
    reader_hostgroup: "{{ hostgroup_reader }}"
    load_to_runtime: yes
  register: out

- name: state must not be changed
  assert:
    that:
      - out is not changed

- name: delete replocation hostgroup
  proxysql_replication_hostgroups:
    login_user: "{{ proxy_sql_admin_user }}"
    login_password: "{{ proxy_sql_admin_password }}"
    writer_hostgroup: "{{ hostgroup_writer }}"
    reader_hostgroup: "{{ hostgroup_reader }}"
    state: absent

- name: create with comment and check_type
  proxysql_replication_hostgroups:
    login_user: "{{ proxy_sql_admin_user }}"
    login_password: "{{ proxy_sql_admin_password }}"
    state: present
    comment: ANSIBLE POWER!!!!
    check_type: innodb_read_only
    writer_hostgroup: "{{ hostgroup_writer }}"
    reader_hostgroup: "{{ hostgroup_reader }}"
    load_to_runtime: yes
  register: out

- name: state must not be changed
  assert:
    that:
      - out is changed
