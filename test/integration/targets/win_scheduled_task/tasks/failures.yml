# test out the known failure cases to ensure we have decent error messages
---
- name: fail create task without an action
  win_scheduled_task:
    name: '{{test_scheduled_task_name}}'
    state: present
  register: fail_create_without_action
  failed_when: fail_create_without_action.msg != 'cannot create a task with no actions, set at least one action with a path to an executable'

- name: fail both username and group are set
  win_scheduled_task:
    name: '{{test_scheduled_task_name}}'
    state: present
    username: '{{ansible_user}}'
    group: '{{ansible_user}}'
  register: fail_username_and_group
  failed_when: fail_username_and_group.msg != 'username and group can not be set at the same time'

- name: fail logon type password but no password set
  win_scheduled_task:
    name: '{{test_scheduled_task_name}}'
    state: present
    logon_type: password
  register: fail_lt_password_not_set
  failed_when: fail_lt_password_not_set.msg != 'password must be set when logon_type=password'

- name: fail logon type s4u but no password set
  win_scheduled_task:
    name: '{{test_scheduled_task_name}}'
    state: present
    logon_type: s4u
  register: fail_lt_s4u_not_set
  failed_when: fail_lt_s4u_not_set.msg != 'password must be set when logon_type=s4u'

- name: fail logon type group but no group set
  win_scheduled_task:
    name: '{{test_scheduled_task_name}}'
    state: present
    logon_type: group
  register: fail_lt_group_not_set
  failed_when: fail_lt_group_not_set.msg != 'group must be set when logon_type=group'

- name: fail logon type service but non service user set
  win_scheduled_task:
    name: '{{test_scheduled_task_name}}'
    state: present
    logon_type: service_account
    username: '{{ansible_user}}'
  register: fail_lt_service_invalid_user
  failed_when: fail_lt_service_invalid_user.msg != 'username must be SYSTEM, LOCAL SERVICE or NETWORK SERVICE when logon_type=service_account'

- name: fail trigger with no type
  win_scheduled_task:
    name: '{{test_scheduled_task_name}}'
    state: present
    triggers:
    - delay: test
  register: fail_trigger_no_type
  failed_when: fail_trigger_no_type.msg != "a trigger entry must contain a key 'type' with a value of 'event', 'time', 'daily', 'weekly', 'monthly', 'monthlydow', 'idle', 'registration', 'boot', 'logon', 'session_state_change'"

# trigger option with datetime but not in correct format

# trigger option not in XML duration format

# trigger option invalid day of the week

# trigger option invalid day of the month

# trigger option invalid week of the month

# trigger option invalid month of the year
