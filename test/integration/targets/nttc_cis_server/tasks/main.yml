# Operations: create, create_linux, create_windows, update, update_nostart,
# expand_disk, command_stop, command_start, command_reboot, delete, delete_all
#
# When using expand disk you may have to retrieve the disk UUID first using the
# nttc_cis_server_info module (or if you wrote the UUID down when with the output
# of the task when the server was created) and update the expand_disk task here.
- hosts: 127.0.0.1
  connection: local
  tasks:
  - name: Create a Linux server
    nttc_cis_server:
      region: na
      datacenter: NA12
      name: myServer01
      image: "CentOS 7 64-bit 2 CPU"
      memory_gb: 2
      network_info:
        network_domain: myCND
        primary_nic:
          vlan: myVLAN
      start: True
      state: present
    register: server
    tags:
      - create
      - create_linux

  - debug:
      var: server
    tags:
      - create
      - create_linux

  - name: Create a Windows server
    nttc_cis_server:
      region: na
      datacenter: NA12
      name: myServer02
      image: "Windows2019 Std 2 CPU"
      disks:
        - id: eb5fb1f2-6ea4-44f4-bef5-881870bf0ad2
          speed: PROVISIONEDIOPS
          iops: 200
      cpu:
        speed: STANDARD
        count: 2
        coresPerSocket: 2
      primary_dns: "10.1.77.10"
      secondary_dns: "10.1.77.11"
      network_info:
        network_domain: "myCND"
        primary_nic:
          vlan: myVLAN
        additional_nic:
          - networkAdapter: VMXNET3
            vlan: "myVLAN2"
            privateIpv4: "10.1.78.20"
      start: False
      state: present
    register: server2
    tags:
      - create
      - create_windows

  - debug:
      var: server2
    tags:
      - create
      - create_windows

  - name: Update a server (CPU and RAM)
    nttc_cis_server:
      region: na
      datacenter: NA12
      network_domain: myCND
      vlan: myVLAN
      name: myServer02
      memory_gb: 6
      cpu:
        count: 4
        coresPerSocket: 4
      state: present
      start: True
    register: server2
    tags:
      - update

  - debug:
      var: server2
    tags:
      - update

  - name: Update a server (CPU and RAM)
    nttc_cis_server:
      region: na
      datacenter: NA12
      network_domain: myCND
      vlan: myVLAN
      name: myServer02
      memory_gb: 6
      cpu:
        count: 4
        coresPerSocket: 4
      state: present
      start: False
    register: server2
    tags:
      - update_nostart

  - debug:
      var: server2
    tags:
      - update_nostart

  - name: Command (stop) a server
    nttc_cis_server:
      region: na
      datacenter: NA12
      network_domain: myCND
      name: myServer02
      state: stop
    register: server
    tags:
      - command_stop

  - debug:
      var: server
    tags:
      - command_stop

  - name: Command (hard_stop) a server
    nttc_cis_server:
      region: na
      datacenter: NA12
      network_domain: myCND
      name: myServer02
      state: hard_stop
    register: server
    tags:
      - command_hardstop

  - debug:
      var: server
    tags:
      - command_hardstop

  - name: Expand a disk
    nttc_cis_server:
      region: na
      datacenter: NA12
      network_domain: myCND
      name: myServer02
      disk_id: 4ac854e5-a47c-46b6-99ef-879db3c69a51
      disk_size: 100
      state: expand_disk
    register: server
    tags:
      - expand_disk

  - debug:
      var: server
    tags:
      - expand_disk

  - name: Command (start) a server
    nttc_cis_server:
      region: na
      datacenter: NA12
      network_domain: myCND
      name: myServer02
      state: start
    register: server
    tags:
      - command_start

  - debug:
      var: server
    tags:
      - command_start

  - name: Command (reboot) a server
    nttc_cis_server:
      region: na
      datacenter: NA12
      network_domain: myCND
      name: myServer02
      state: reboot
    register: server
    tags:
      - command_reboot

  - debug:
      var: server
    tags:
      - command_reboot

  - name: Delete the Linux server
    nttc_cis_server:
      region: na
      datacenter: NA12
      name: myServer01
      network_domain: myCND
      state: absent
    register: server
    tags:
      - delete_all

  - debug:
      var: server
    tags:
      - delete_all

  - name: Delete the Windows server
    nttc_cis_server:
      region: na
      datacenter: NA12
      name: myServer02
      network_domain: myCND
      state: absent
    register: server
    tags:
      - delete_all
      - delete

  - debug:
      var: server
    tags:
      - delete_all
      - delete
