---
# tasks file for aws_acm_facts

- name: set up aws connection info
  set_fact:
    aws_connection_info: &aws_connection_info
      aws_access_key: "{{ aws_access_key }}"
      aws_secret_key: "{{ aws_secret_key }}"
      security_token: "{{ security_token }}"
      region: "{{ aws_region }}"
  no_log: yes

- block:
    - name: Get all ACM certificate facts
      aws_acm_facts:
        <<: *aws_connection_info
      register: result

    - assert:
        that:
          - result.changed
          - result.certificates is defined

    - name: Get ACM certificate facts by ARN id
      aws_acm_facts:
        certificate_arn: '{{ acm_arn }}'
        <<: *aws_connection_info
      register: result

    - assert:
        that:
          - result.changed

    - name: Get ACM certificate facts by domain name
      aws_acm_facts:
        domain_name: '{{ acm_domain }}'
        <<: *aws_connection_info
      register: result

    - assert:
        that:
          - result.changed
