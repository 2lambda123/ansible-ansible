---
- name: uninstall any versions of modules used for tests
  win_shell: 'Uninstall-Module {{ item }} -AllVersions -Force -ErrorAction Ignore'
  changed_when: false
  with_items:
    - "powershell-yaml"
    - "Pester"
    - "PowerShellCookbook"
    - "Format-Pester"

- name: unregister the custom repo
  win_shell: 'Unregister-PSRepository {{ custom_repo_name }} -ErrorAction Ignore'

- name: remove the custom repo folder
  win_shell: 'Remove-Item {{ custom_repo_path }} -Recurse -Force -ErrorAction Ignore'
  ignore_errors: yes