---
- name: Test Zipping file
  debug:
    msg: "Testing zip of single file"

- name: Zip up single file
  win_zip:
    src: "{{ working_dir }}\\dir1\\test1.txt"
    dest: "{{ target_zip_destfile }}"
  register: filezip_task

- name: Assert task is changed
  assert:
    that:
      - "filezip_task|changed"

- name: Assert zip exists
  include_tasks: assert_exists.yml
  vars:
    target: "{{ target_zip_destfile }}"

- name: Assert original dir wasn't deleted
  include_tasks: assert_exists.yml
  vars:
    target: "{{ working_dir }}\\dir1"

- name: Remove zip file
  win_file:
    path: "{{ target_zip_destfile }}"
    state: absent