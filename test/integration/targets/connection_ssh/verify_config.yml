- hosts: localhost
  gather_facts: false
  vars:
    str_ssh_configs:
      - ssh_common_args
      - ssh_extra_args
      - sftp_extra_args
      - scp_extra_args
    bool_ssh_configs:
      - pipelining
    int_ssh_configs:
      - timeout
  tasks:
    - debug:
        msg: '{{item ~ ": " ~ lookup("config", item, plugin_type="connection", plugin_name="ssh")}}'
        verbosity: 3
      loop: '{{str_ssh_configs + bool_ssh_configs + int_ssh_configs}}'
      tags: [ configfile ]

    - name: check str config from file
      assert:
        that:
          - 'lookup("config", item, plugin_type="connection", plugin_name="ssh") == "fromconfig"'
      loop: '{{str_ssh_configs}}'
      tags: [ configfile ]

    - name: check bool config from file
      assert:
        that:
          - 'lookup("config", item, plugin_type="connection", plugin_name="ssh") == True'
      loop: '{{bool_ssh_configs}}'
      tags: [ configfile ]

    - name: check int config from file
      assert:
        that:
          - 'lookup("config", item, plugin_type="connection", plugin_name="ssh") == 1'
      loop: '{{int_ssh_configs}}'
      tags: [ configfile ]
