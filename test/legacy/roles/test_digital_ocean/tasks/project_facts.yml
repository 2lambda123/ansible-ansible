---
- name: Query all projects
  digital_ocean_project_facts:
    oauth_token: "{{ digitalocean_oauth_token }}"
  register: query_all


- name: Create new project
  digital_ocean_project:
    state: present
    name: IntTestProject
    description: Project created for integration test
    purpose: Just trying out DigitalOcean
    environment: development
    oauth_token: "{{ digitalocean_oauth_token }}"
  register: create

- assert:
    that:
      - create.data.name == IntTestProject
      - create.data.description == "Project created for integration test"
      - create.changed == True

- name: Modify project
  digital_ocean_project:
    state: present
    name: IntTestProject
    description: Modified description
    purpose: Just trying out DigitalOcean
    environment: development
    default: no
    oauth_token: "{{ digitalocean_oauth_token }}"
  register: modified

- assert:
    that:
      - modified.data.name == IntTestProject
      - modified.data.description == "Modified description"
      - modified.changed == True