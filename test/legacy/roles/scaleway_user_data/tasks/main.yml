# SCW_API_KEY='XXX' ansible-playbook ./test/legacy/scaleway.yml --tags test_scaleway_user_data

- name: Create a server
  scaleway_compute:
    name: '{{ instance_name }}'
    state: present
    image: '{{ scaleway_image_id }}'
    organization: '{{ scaleway_organization }}'
    region: '{{ scaleway_region }}'
    commercial_type: '{{ scaleway_commerial_type }}'
    wait: true

  register: server_creation_task

- debug: var=server_creation_task

- name: Assign the id of the test server
  set_fact:
    server_id: "{{ server_creation_task.msg.id }}"

- name: Print the id of the test server
  debug: var=server_id

#- include: crud.yml
- include: unicode.yml

#- name: Destroy it
#  scaleway_compute:
#    name: '{{ instance_name }}'
#    state: absent
#    region: '{{ scaleway_region }}'
#    image: '{{ scaleway_image_id }}'
#    organization: '{{ scaleway_organization }}'
#    commercial_type: '{{ scaleway_commerial_type }}'
#    wait: true
#  register: server_destroy_task
#
#- debug: var=server_destroy_task
