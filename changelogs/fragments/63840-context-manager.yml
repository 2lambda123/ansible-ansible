bugfixes:
  - use a context manager for file handling in many places.
